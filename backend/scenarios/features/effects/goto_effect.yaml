metadata:
  name: "Effects - Goto Node Transition"
  description: "Test goto effect for transitioning between nodes"
  game: "coffeeshop_date"
  author: "PlotPlay Team"
  tags: ["feature-effects", "phase-1", "goto"]

mocks:
  writer:
    intro: "You step onto the sunlit cafe patio. The aroma of fresh coffee fills the air. You spot Alex at one of the tables."
    greet: "Alex looks up from their phone and smiles warmly. 'Hey! Glad you could make it.'"
    order: "Inside, the scent of espresso wraps around you. Alex scans the chalkboard menu with a decisive nod."

  checker:
    default:
      meters: {}
      flags: {}
      character_memories: {}
      safety:
        ok: true

steps:
  - name: "Start at outside_cafe node"
    action: start
    mock_writer_key: intro
    expect:
      node: "outside_cafe"

  - name: "Choose greet_warmly (has goto: order_drinks)"
    action: choice
    choice_id: "greet_warmly"
    mock_writer_key: greet
    expect:
      node: "order_drinks"
      narrative_contains:
        - "Alex"

  - name: "Choose split_the_bill (has goto: table_convo)"
    action: choice
    choice_id: "split_the_bill"
    mock_writer_key: order
    expect:
      node: "table_convo"
